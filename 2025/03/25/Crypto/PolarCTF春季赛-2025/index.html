<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PolarCTF春季赛 2025 | Qwe7sea_Blog</title>
  <meta name="keywords" content=" Crypto ">
  <meta name="description" content="PolarCTF春季赛 2025 | Qwe7sea_Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="本博客使用Github+Hexo框架搭建  文章：篇；总字数：字； 访问人数：人，访问量：次。">
<meta property="og:type" content="website">
<meta property="og:title" content="about">
<meta property="og:url" content="http://example.com/about/index.html">
<meta property="og:site_name" content="Qwe7sea_Blog">
<meta property="og:description" content="本博客使用Github+Hexo框架搭建  文章：篇；总字数：字； 访问人数：人，访问量：次。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-01-23T03:14:54.000Z">
<meta property="article:modified_time" content="2025-02-06T14:11:31.760Z">
<meta property="article:author" content="Qwe7sea">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Qwe7sea</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/Qwe7sea/Qwe7sea.github.io"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(19)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="Web">
            <i class="fold iconfont icon-right"></i>
            Web
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Web&lt;---&gt;php">
            
            php
            <small>(2)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="密码学">
            <i class="fold iconfont icon-right"></i>
            密码学
            <small>(13)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="密码学&lt;---&gt;对称加密">
            
            对称加密
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="密码学&lt;---&gt;非对称加密">
            
            非对称加密
            <small>(3)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="密码学&lt;---&gt;流密码">
            
            流密码
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="密码学&lt;---&gt;数论">
            
            数论
            <small>(3)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="密码学&lt;---&gt;RSA">
            
            RSA
            <small>(2)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="CTF比赛">
            
            CTF比赛
            <small>(3)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="19">
<input type="hidden" id="yelog_site_word_count" value="43.6k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://github.com/Qwe7sea/Qwe7sea.github.io">项目地址</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>大整数分解</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>离散对数</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>数论</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Coppersmith</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CRT</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Crypto</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ECC</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>LCG</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>php</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RSA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>XOR</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="全部文章 Web php "
           href="/2025/05/09/Web/PHP%E7%9B%B8%E5%85%B3%E5%8F%8A%E7%BB%95%E8%BF%87/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="PHP相关及绕过">PHP相关及绕过</span>
            <span class="post-date" title="2025-05-09 10:45:43">2025/05/09</span>
        </a>
        
        
        <a  class="全部文章 Web php "
           href="/2025/05/09/Web/PHP%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87/"
           data-tag="php"
           data-author="" >
            <span class="post-title" title="PHP函数绕过">PHP函数绕过</span>
            <span class="post-date" title="2025-05-09 10:42:56">2025/05/09</span>
        </a>
        
        
        <a  class="全部文章 密码学 非对称加密 "
           href="/2025/05/06/Crypto/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E9%97%AE%E9%A2%98/"
           data-tag="Crypto,离散对数"
           data-author="" >
            <span class="post-title" title="离散对数问题">离散对数问题</span>
            <span class="post-date" title="2025-05-06 15:06:45">2025/05/06</span>
        </a>
        
        
        <a  class="全部文章 密码学 流密码 "
           href="/2025/04/02/Crypto/LCG%E5%9F%BA%E7%A1%80/"
           data-tag="Crypto,LCG"
           data-author="" >
            <span class="post-title" title="LCG基础">LCG基础</span>
            <span class="post-date" title="2025-04-02 10:03:31">2025/04/02</span>
        </a>
        
        
        <a  class="全部文章 CTF比赛 "
           href="/2025/03/25/Crypto/PolarCTF%E6%98%A5%E5%AD%A3%E8%B5%9B-2025/"
           data-tag="Crypto"
           data-author="" >
            <span class="post-title" title="PolarCTF春季赛 2025">PolarCTF春季赛 2025</span>
            <span class="post-date" title="2025-03-25 09:07:27">2025/03/25</span>
        </a>
        
        
        <a  class="全部文章 密码学 非对称加密 "
           href="/2025/03/10/Crypto/ECC%E5%AF%86%E7%A0%81/"
           data-tag="Crypto,ECC"
           data-author="" >
            <span class="post-title" title="ECC加密解密">ECC加密解密</span>
            <span class="post-date" title="2025-03-10 10:55:24">2025/03/10</span>
        </a>
        
        
        <a  class="全部文章 密码学 对称加密 "
           href="/2025/03/06/Crypto/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/"
           data-tag="Crypto,XOR"
           data-author="" >
            <span class="post-title" title="对称加密">对称加密</span>
            <span class="post-date" title="2025-03-06 17:29:40">2025/03/06</span>
        </a>
        
        
        <a  class="全部文章 密码学 RSA "
           href="/2025/03/06/Crypto/%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5%E6%8E%A8%E5%AF%BC/"
           data-tag="Crypto"
           data-author="" >
            <span class="post-title" title="特殊情况推导">特殊情况推导</span>
            <span class="post-date" title="2025-03-06 10:10:42">2025/03/06</span>
        </a>
        
        
        <a  class="全部文章 密码学 RSA "
           href="/2025/03/05/Crypto/%E5%B7%B2%E7%9F%A5%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB/"
           data-tag="Crypto,Coppersmith"
           data-author="" >
            <span class="post-title" title="已知高位攻击">已知高位攻击</span>
            <span class="post-date" title="2025-03-05 17:04:08">2025/03/05</span>
        </a>
        
        
        <a  class="全部文章 CTF比赛 "
           href="/2025/02/25/Crypto/CryptoCTF-2020/"
           data-tag="Crypto,CRT"
           data-author="" >
            <span class="post-title" title="CryptoCTF 2020">CryptoCTF 2020</span>
            <span class="post-date" title="2025-02-25 17:30:35">2025/02/25</span>
        </a>
        
        
        <a  class="全部文章 密码学 "
           href="/2025/02/25/Crypto/Sagemath%E4%BD%BF%E7%94%A8%E5%AD%A6%E4%B9%A0/"
           data-tag="Crypto"
           data-author="" >
            <span class="post-title" title="sagemath的使用">sagemath的使用</span>
            <span class="post-date" title="2025-02-25 11:04:12">2025/02/25</span>
        </a>
        
        
        <a  class="全部文章 密码学 "
           href="/2025/02/13/Crypto/Crypro-CTF%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B/"
           data-tag="Crypto"
           data-author="" >
            <span class="post-title" title="Crypro-CTF常见题型">Crypro-CTF常见题型</span>
            <span class="post-date" title="2025-02-13 16:44:57">2025/02/13</span>
        </a>
        
        
        <a  class="全部文章 密码学 数论 "
           href="/2025/02/13/Crypto/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/"
           data-tag="Crypto,数论"
           data-author="" >
            <span class="post-title" title="离散对数">离散对数</span>
            <span class="post-date" title="2025-02-13 16:23:22">2025/02/13</span>
        </a>
        
        
        <a  class="全部文章 密码学 数论 "
           href="/2025/02/10/Crypto/%E5%90%8C%E4%BD%99%E7%90%86%E8%AE%BA/"
           data-tag="Crypto,CRT"
           data-author="" >
            <span class="post-title" title="同余理论">同余理论</span>
            <span class="post-date" title="2025-02-10 11:27:51">2025/02/10</span>
        </a>
        
        
        <a  class="全部文章 CTF比赛 "
           href="/2025/02/08/Crypto/VNCTF%202025/"
           data-tag="Crypto,CRT"
           data-author="" >
            <span class="post-title" title="VNCTF 2025">VNCTF 2025</span>
            <span class="post-date" title="2025-02-08 11:32:32">2025/02/08</span>
        </a>
        
        
        <a  class="全部文章 密码学 数论 "
           href="/2025/02/05/Crypto/%E8%BF%9E%E5%88%86%E6%95%B0/"
           data-tag="Crypto,数论"
           data-author="" >
            <span class="post-title" title="连分数">连分数</span>
            <span class="post-date" title="2025-02-05 11:46:08">2025/02/05</span>
        </a>
        
        
        <a  class="全部文章 密码学 非对称加密 "
           href="/2025/01/24/Crypto/RSA%E7%9B%B8%E5%85%B3/"
           data-tag="Crypto,RSA,大整数分解"
           data-author="" >
            <span class="post-title" title="RSA加密">RSA加密</span>
            <span class="post-date" title="2025-01-24 09:56:53">2025/01/24</span>
        </a>
        
        
        <a  class="全部文章 密码学 "
           href="/2025/01/23/Crypto/CTF%E7%AB%9E%E8%B5%9B%E5%AF%86%E7%A0%81%E5%AD%A6%E6%8C%87%E5%8D%97/"
           data-tag="Crypto"
           data-author="" >
            <span class="post-title" title="CTF竞赛密码学指南">CTF竞赛密码学指南</span>
            <span class="post-date" title="2025-01-23 11:57:56">2025/01/23</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2025/01/22/%E9%83%A8%E7%BD%B2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="部署">部署</span>
            <span class="post-date" title="2025-01-22 18:26:35">2025/01/22</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Crypto/PolarCTF春季赛-2025" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">PolarCTF春季赛 2025</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF比赛">CTF比赛</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color2">Crypto</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2025-04-08 15:20:14'>2025-03-25 09:07</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:1.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#knockknock"><span class="toc-text">knockknock</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LCG"><span class="toc-text">LCG</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#beginner"><span class="toc-text">beginner</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA1-2"><span class="toc-text">RSA1-2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ununicast"><span class="toc-text">Ununicast</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#playstreamone"><span class="toc-text">playstreamone</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-6 i,
    .toc-level-6 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="knockknock"><a href="#knockknock" class="headerlink" title="knockknock"></a>knockknock</h1><p>题目：</p>
<blockquote>
<p>前景：Rowrow always takes the lead, but Colcol isn’t happy about it. This time, he wants to walk ahead of Rowrow. Rowrow agrees, so he lets him go first.</p>
<p>（44 32 42 34）（42 34）（45 43 54 24）（31 32 11 23 53 42 43 33）</p>
<p>hint ：32位小写MD5加密</p>
</blockquote>
<p>分析：</p>
<p>根据提示：常规解密都是行列的顺序，现在换成了先列后行的顺序</p>
<p>敲击码(Tap code)</p>
<ul>
<li>一种以非常简单的方式对文本信息进行编码的方法</li>
<li>因该编码对信息通过使用一系列的点击声音来编码而命名</li>
<li>基于5×5方格波利比奥斯方阵来实现的，不同点是用K字母被整合到C中</li>
</ul>
<p><img src="/../images/%E6%AF%94%E8%B5%9B/a1d40fe5cfc9015bab408b62533c40c7.png" alt="在这里插入图片描述"><br> <img src="/../images/%E6%AF%94%E8%B5%9B/4783453307d2afba07e1c51fed50f3ee.png" alt="在这里插入图片描述"></p>
<p>相关资料：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44604541/article/details/109817480">https://blog.csdn.net/weixin_44604541/article/details/109817480</a></p>
<p>因此，根据先列后行的规则解密出来：THIS IS YOUR CHAMPION</p>
<p>得到flag{ac4826f8687d1108915e2118e54e0984}</p>
<h1 id="LCG"><a href="#LCG" class="headerlink" title="LCG"></a>LCG</h1><p>题目：</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a =  <span class="number">156506070439514915241840745761803504236863873655854161309517219593159285490218416513868431750791509039364033002042672969954633160268127141912185884526880436614313300761314810148356686577662643452299620703125833160716418003026915719584690230453993382155777985020586206612864299316237848416232290650753975103343</span></span><br><span class="line">b =  <span class="number">99238154412252510462155206432285862925162164007834452250464130686978914370223020006347851539449419633688760095534852514797292083351953228730558335170313299274579966373474363445106224340638196799329142279344558612634392675992734275683700752827665429269516389277374408716314038483357418130704741371183923688601</span></span><br><span class="line">c =  <span class="number">46154227430594568448486764587707836676441274677362557668215680998009402508945237578201692757688901737765923819819981974561807236454825684824157481322486008937560337004555948283870920377643907746645702190355761172293685309340938249454686807948964629553755585562990983237480387614548526918576791297250747752579</span></span><br><span class="line">m =  <span class="number">94993804003827679355988952056520996247311128806455111011781585397953533782675757682874584547665028872979112598462143541626190903596606261782592703863749024490737374603789002750194481545579020929239629410573307193150780522563772690101754723829224534622557370960012364614566294197235191962517037441643656951249</span></span><br><span class="line">一共循环十次</span><br></pre></td></tr></table></figure></blockquote>
<p>分析：</p>
<p>相关参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74345946/article/details/132888135">https://blog.csdn.net/m0_74345946/article/details/132888135</a></p>
<p>LCG中已知a,b,m，可直接逆序推出$X_0$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a =  <span class="number">156506070439514915241840745761803504236863873655854161309517219593159285490218416513868431750791509039364033002042672969954633160268127141912185884526880436614313300761314810148356686577662643452299620703125833160716418003026915719584690230453993382155777985020586206612864299316237848416232290650753975103343</span></span><br><span class="line">b =  <span class="number">99238154412252510462155206432285862925162164007834452250464130686978914370223020006347851539449419633688760095534852514797292083351953228730558335170313299274579966373474363445106224340638196799329142279344558612634392675992734275683700752827665429269516389277374408716314038483357418130704741371183923688601</span></span><br><span class="line">c =  <span class="number">46154227430594568448486764587707836676441274677362557668215680998009402508945237578201692757688901737765923819819981974561807236454825684824157481322486008937560337004555948283870920377643907746645702190355761172293685309340938249454686807948964629553755585562990983237480387614548526918576791297250747752579</span></span><br><span class="line">m =  <span class="number">94993804003827679355988952056520996247311128806455111011781585397953533782675757682874584547665028872979112598462143541626190903596606261782592703863749024490737374603789002750194481545579020929239629410573307193150780522563772690101754723829224534622557370960012364614566294197235191962517037441643656951249</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a_inv = invert(a,m)</span><br><span class="line">seed = c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a_inv * (seed-b))%m</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(seed))</span><br><span class="line"><span class="comment">#flag&#123;lcglcglcglcglcglcglcglcg&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="beginner"><a href="#beginner" class="headerlink" title="beginner"></a>beginner</h1><p>题目：</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()) &lt;= <span class="number">50</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">str</span>(<span class="built_in">int</span>.from_bytes(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read(), byteorder=<span class="string">&#x27;big&#x27;</span>) &lt;&lt; <span class="number">10000</span>).endswith(<span class="string">&#x27;16732186163543403522711798960598469149029861032300263763941636254755451456334507142958574415880945599253440468447483752611840&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#endwith后为125位</span></span><br><span class="line"><span class="comment">#其中加密方式为utf-8</span></span><br></pre></td></tr></table></figure></blockquote>
<p>分析：</p>
<p><code>flag.txt</code> 的文件大小不超过 50 字节。</p>
<p>将 <code>flag.txt</code> 的内容转换为大端序整数，左移 10000 位后，其十进制表示必须以给定的 125 位数字结尾。</p>
<p>相关参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Luiino/article/details/127153069">https://blog.csdn.net/Luiino/article/details/127153069</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span>(<span class="built_in">str</span>(<span class="built_in">int</span>.from_bytes(<span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read(), byteorder=<span class="string">&#x27;big&#x27;</span>) &lt;&lt; <span class="number">10000</span>).endswith(<span class="string">&#x27;1002773875431658367671665822006771085816631054109509173556585546508965236428620487083647585179992085437922318783218149808537210712780660412301729655917441546549321914516504576&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>将二进制的明文进行左移10000操作，即乘上2*10000，并给了转成十进制后的明文的后125位。</p>
<p>故可以得到下面的关系式：</p>
<p>$c &#x3D; 2^10000 * m (mod 10^125)$推导一下：</p>
<p>$2^10000 * m&#x2F;c &#x3D; 1 (mod 10^125)$，故$m &#x3D; c * (2^10000)^{-1} (mod 10^125)$，通过计算发现，该逆元不存在，因为2^10000和10^125间有公因数2^125，把它约去即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的结尾数字</span></span><br><span class="line">c = <span class="number">16732186163543403522711798960598469149029861032300263763941636254755451456334507142958574415880945599253440468447483752611840</span></span><br><span class="line"><span class="comment"># 计算 2^10000 的逆元模 5^125</span></span><br><span class="line">inv_2_10000 = <span class="built_in">pow</span>(<span class="number">2</span>, -<span class="number">10000</span>, <span class="number">5</span>**<span class="number">125</span>)</span><br><span class="line"></span><br><span class="line">m = (c * inv_2_10000) % (<span class="number">5</span>**<span class="number">125</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;qwert_yuioplk_jhgfdsa_zxcv_bnm&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="RSA1-2"><a href="#RSA1-2" class="headerlink" title="RSA1-2"></a>RSA1-2</h1><p>题目：</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">bits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">polar</span>(<span class="params">msg: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">bytearray</span>], length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">assert</span> length &gt; <span class="built_in">len</span>(msg), <span class="string">&quot;指定的长度必须大于原始消息长度加 1。&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(msg) + <span class="string">b&#x27;\x00&#x27;</span> + os.urandom(length - <span class="built_in">len</span>(msg) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unpolar</span>(<span class="params">msg: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">bytearray</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    msg = <span class="built_in">bytes</span>(msg)</span><br><span class="line">    <span class="keyword">assert</span> <span class="string">b&#x27;\x00&#x27;</span> <span class="keyword">in</span> msg, <span class="string">&quot;输入的字节串中不包含分隔符。&quot;</span></span><br><span class="line">    <span class="keyword">return</span> msg.split(<span class="string">b&#x27;\x00&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag1</span>(<span class="params">m</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        result.append(getPrime(bits))</span><br><span class="line">    p, q = result</span><br><span class="line">    <span class="keyword">if</span> p &lt;= q:</span><br><span class="line">        p, q = q, p</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    n = p * q</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    hint = <span class="built_in">pow</span>(<span class="number">2024</span> * p + <span class="number">2025</span>, q, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------- getflag 1 ----------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag2</span>(<span class="params">m</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        result.append(getPrime(bits))</span><br><span class="line">    p, q = result</span><br><span class="line">    n = p * q</span><br><span class="line">    hint1 = <span class="built_in">pow</span>(m, p, n)</span><br><span class="line">    hint2 = <span class="built_in">pow</span>(m, q, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------- getflag 2 ----------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint1 = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint2 = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag3</span>(<span class="params">m</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        result.append(getPrime(bits))</span><br><span class="line">    p, q = result</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    n = p * q</span><br><span class="line">    g = <span class="number">20242025</span></span><br><span class="line">    hint = <span class="built_in">pow</span>(g + p * <span class="number">1111</span>, e, n)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------- getflag 3 ----------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">42</span></span><br><span class="line">mm = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">42</span>, <span class="number">14</span>):</span><br><span class="line">    mm.append(bytes_to_long(polar(flag[i:i + <span class="number">14</span>], bits // <span class="number">4</span> - <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">m1, m2, m3 = mm</span><br><span class="line">getflag1(m1)</span><br><span class="line">getflag2(m2)</span><br><span class="line">getflag3(m3)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">---------- getflag <span class="number">1</span> ----------</span><br><span class="line">c = <span class="number">106932814634172489425702007139140373546834917771367058711944984593149465629951198769828679883270594158665297746680289248056977346295975218434156754937039740474715490069136163100111573379630763755493571058775063239132348709658984213922635566937023561820595839822600865948106997713601138967967447835143132518249</span></span><br><span class="line">n = <span class="number">114546425588310081671864824979705524066909097193297064099051733046402463555650788674630216283713981601352701801247525374203450930718461734483264497798387006484238009970986630571854153754756808866976403302100414756641710076386950849275884332309214691647884729239866449303022190966328416202728653161194734181397</span></span><br><span class="line">hint = <span class="number">14167026592757385645683964635731214642720851230816007832728179594137078788184547251188361494083671558554399706352083594406586455990047883120343525622731906783627614035714546815384092987686711187001531557864904478781545860378341648063119238398535969022698033097727057913728653478849054917253235938883271690040</span></span><br><span class="line">---------- getflag <span class="number">2</span> ----------</span><br><span class="line">hint1 = <span class="number">54970781924019595863484530626735693712920476619483230578277656430455790362335041922354389265430681573039703011001631761902508906456609398108389457140693872973125229844737616298484143628327833079090999615173264817695407599821875528027430069058944656983590302062976047694462479290647389958480266319059751445182</span></span><br><span class="line">hint2 = <span class="number">80980259919808074704372134146767866092949512532096534576106851289748846005248116120680155543668224921613789932208624456370489831230478815466334144780133065025062986201532876895224101781697909762258725545339404197634465901767246731955823620770784243939730616060814584918359635917314703766496053543724484797173</span></span><br><span class="line">n = <span class="number">99517070479321715054584809647801078099246408970263686466424530637818701832562120579305425855216653939240321111911361599565693184872902069364547154817279854814534957350288095457061287301409197137152708536099357243361609267071166651650163387054480968146813088675351466317148500854487952501075120046716531779527</span></span><br><span class="line">---------- getflag <span class="number">3</span> ----------</span><br><span class="line">c = <span class="number">51100026339357786159146465987268050654484932407305430030434719506588905998943430883131311324670025897109006729477302362003557202463770250321227873150557579374770683129700977409481692251037899461661968708767126966344274947046391169588818731128072220629623368296581244087481436853929555771832747210836109696703</span></span><br><span class="line">n = <span class="number">85897150916833688522635686742994777963661211681341125201267041008790197490758867298985626011222830465064289727655147523984810647113543131152913693609062807059393201711922197064632101712280889245466817477074958630885164568068656410500872384462043993495454174325021766338459126370431040295739507618513598240657</span></span><br><span class="line">hint = <span class="number">74207877151043153331465477182019527898792092627334195908322826913320865766713698819838691762501128169631345035620355122351143434970770413620094036828820672753396419434430235436928712839835293124866139083678902005527999303052152257999599043696672040830910609582145273960759790396567889053040599505269507804705</span></span><br></pre></td></tr></table></figure></blockquote>
<p>分析：</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ---------- flag 1 ----------</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">c = <span class="number">106932814634172489425702007139140373546834917771367058711944984593149465629951198769828679883270594158665297746680289248056977346295975218434156754937039740474715490069136163100111573379630763755493571058775063239132348709658984213922635566937023561820595839822600865948106997713601138967967447835143132518249</span></span><br><span class="line">n = <span class="number">114546425588310081671864824979705524066909097193297064099051733046402463555650788674630216283713981601352701801247525374203450930718461734483264497798387006484238009970986630571854153754756808866976403302100414756641710076386950849275884332309214691647884729239866449303022190966328416202728653161194734181397</span></span><br><span class="line">hint = <span class="number">14167026592757385645683964635731214642720851230816007832728179594137078788184547251188361494083671558554399706352083594406586455990047883120343525622731906783627614035714546815384092987686711187001531557864904478781545860378341648063119238398535969022698033097727057913728653478849054917253235938883271690040</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="comment"># hint = pow(2024 * p + 2025, q, n)</span></span><br><span class="line">p = gcd(<span class="built_in">pow</span>(<span class="number">2025</span>,n,n) - hint, n)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag1 = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag1[:<span class="number">14</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------- flag 2 ----------</span></span><br><span class="line">hint1 = <span class="number">54970781924019595863484530626735693712920476619483230578277656430455790362335041922354389265430681573039703011001631761902508906456609398108389457140693872973125229844737616298484143628327833079090999615173264817695407599821875528027430069058944656983590302062976047694462479290647389958480266319059751445182</span></span><br><span class="line">hint2 = <span class="number">80980259919808074704372134146767866092949512532096534576106851289748846005248116120680155543668224921613789932208624456370489831230478815466334144780133065025062986201532876895224101781697909762258725545339404197634465901767246731955823620770784243939730616060814584918359635917314703766496053543724484797173</span></span><br><span class="line">n = <span class="number">99517070479321715054584809647801078099246408970263686466424530637818701832562120579305425855216653939240321111911361599565693184872902069364547154817279854814534957350288095457061287301409197137152708536099357243361609267071166651650163387054480968146813088675351466317148500854487952501075120046716531779527</span></span><br><span class="line"><span class="comment"># n = p * q</span></span><br><span class="line"><span class="comment"># hint1 = pow(m, p, n)</span></span><br><span class="line"><span class="comment"># hint2 = pow(m, q, n)</span></span><br><span class="line">p = gcd(<span class="built_in">pow</span>(hint1,n,n) - hint2, n)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(p,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(hint1,d,n)</span><br><span class="line">flag2 = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag2[:<span class="number">14</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------- flag 3 ----------</span></span><br><span class="line">c = <span class="number">51100026339357786159146465987268050654484932407305430030434719506588905998943430883131311324670025897109006729477302362003557202463770250321227873150557579374770683129700977409481692251037899461661968708767126966344274947046391169588818731128072220629623368296581244087481436853929555771832747210836109696703</span></span><br><span class="line">n = <span class="number">85897150916833688522635686742994777963661211681341125201267041008790197490758867298985626011222830465064289727655147523984810647113543131152913693609062807059393201711922197064632101712280889245466817477074958630885164568068656410500872384462043993495454174325021766338459126370431040295739507618513598240657</span></span><br><span class="line">hint = <span class="number">74207877151043153331465477182019527898792092627334195908322826913320865766713698819838691762501128169631345035620355122351143434970770413620094036828820672753396419434430235436928712839835293124866139083678902005527999303052152257999599043696672040830910609582145273960759790396567889053040599505269507804705</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">g = <span class="number">20242025</span></span><br><span class="line"><span class="comment"># hint = pow(g + p * 1111, e, n)</span></span><br><span class="line"><span class="comment"># c = pow(m, e, n)</span></span><br><span class="line">p = gcd(hint - <span class="built_in">pow</span>(g,e,n), n)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag3 = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag3[:<span class="number">14</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;230995272dc762941b1d66dg02ca6b3f6889&#125;</span></span><br></pre></td></tr></table></figure>





<h1 id="Ununicast"><a href="#Ununicast" class="headerlink" title="Ununicast"></a>Ununicast</h1><p>题目：</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag) </span><br><span class="line"></span><br><span class="line">n_list = []</span><br><span class="line">c_list = []</span><br><span class="line">q_list = []</span><br><span class="line">p_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):  </span><br><span class="line">    p = libnum.generate_prime(<span class="number">1024</span>) </span><br><span class="line">    q = libnum.generate_prime(<span class="number">1024</span>)  </span><br><span class="line">    n = p * q * (i + <span class="number">1</span>)  </span><br><span class="line"></span><br><span class="line">    p_list.append(p)  </span><br><span class="line">    q_list.append(q)  </span><br><span class="line">    n_list.append(n)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    e = random.randint(<span class="number">10</span>, <span class="number">30</span>)  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_prime(e):  </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n_list)):</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n_list[index])  </span><br><span class="line">    c_list.append(c_list.append(c * (index + <span class="number">1</span>)))  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n&quot;</span> + <span class="built_in">str</span>(index + <span class="number">1</span>) + <span class="string">&quot; =&quot;</span>, n_list[index])  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c&quot;</span> + <span class="built_in">str</span>(index + <span class="number">1</span>) + <span class="string">&quot; =&quot;</span>, c_list[index])  </span><br></pre></td></tr></table></figure></blockquote>
<blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n1 = <span class="number">22103870455568232891149694305142888751834308614394265111616851946569600408214771004642537180847811632101335684526571461971168013515137837024900824805617026937904594229522094231161022911739124543737188196687483192656237801622618078066399259928261566545087643719410735482610730976575506701177108423445928193645406926842010985319473171710362525271971508507747952666476652082985675013329629912123828667561346609223913700779782291638584038925201698832368301491167548373412290987271213331940429281040520028261848410995501268272516219976073764836056701179000719299634048587399330114683369803481960168019956231748933059575086</span></span><br><span class="line">c1 = <span class="number">11932229075145446680509155897048554062128427256365407597246250504495581359308426337230014475362231568192824606320775755785288148002607456528824047021370456983795336102290050703706457189838464034831160081682076095173411617546158489572376376884672473947738113750437924641752734999601688973523833305072494573210602790160977994408649942476416234572187935125916149727341802693373659080702112924850348826357976589797895053949499171267826718541148026541242636886850084012913015158312606367900952240929619627369492395483334316329627526281924799100659188037308919177852074431004118744919974806767580700568542188744931220106105</span></span><br><span class="line">n2 = <span class="number">75527641277099990800438920440041058388427571492243099817050670120985557789492014161535482889418153237600686779752008243731659250445079816272020155052679163716181164111466120389153470493389801068487079484957125572093805976995390398541806299511780722297642464948545911633969882049338027366168822259177038560221615245305724815740962661657512543487558774545803259821939839314547049519064559274668861232108875651136746020639698802437427698294031084596199751751480045337605111284980409927684686225365555725770862339970487179511801140925931587981761559129421142486178642732741442537609122284807214875446647952010067400441059</span></span><br><span class="line">c2 = <span class="number">124027357006179169026958610630330051622067042499828335143384044470302479154098199844981110929954078399392164965842575040140695741764719533745054315027041147434320473103634538090232615962998187567447484128103678001361703834076345621055674269048895730502155866761233018172058631071676397257894588728272913258599692996320058955017804506826897453939809574483310935927402899939042162496213745140970798253433830063777555869660983592646174581212241911650074643983280676238861065129884340834318081282521338654119292893592735294429956139729060770783817702837759047833794757601190967753969500822631312988106678317432186105038268</span></span><br><span class="line">n3 = <span class="number">67087501562139943813249584173215038264768218519355997619681399311361081244680048116472803745503996059873261361695629103578075388683394265112338602330356608572716276538183020643625652731722917269342461918246200053767885270359910155650804090015847462552469649420213346519159991670579334968778366255234963922378971680452094795318028353408405313888877068259282684640458674087251102468714734787171166396014144021959441774122328495595094512659302451021226956296868717965902597097040721193168373568780684532295504916946312087113872338693404258549907349353138009767393388073227204853717415106619739522003848121147803734511476</span></span><br><span class="line">c3 = <span class="number">34907142326483502918854711671956997110565154361385230791804714287500927140885225814711150443792832759398271249995064551044140838772959358268339105708186456545576271462167016667528764892342067422814982959975071847067493078241698635502292984200940132917130864956317815578073656622172241742542237740221147402449228459532782232518010610903660510875077798419046748683570340175197592449547071220020985311569095928938768945219762563190314531483012532595972282105394784611117089120803198848347397871670119847470687912177591609360741114570213377874848453859418234331921560384819899391157666714587396643397702710016410117040255</span></span><br><span class="line">n4 = <span class="number">107655225342909323493747650996643964780949305458547565103531987767712606044684527447631280423897684091717655597473336978923442425477823322239803312759244627308704521511743542550831030718035257133033470431042111429555597381959609892666206716219532081847930970282959800999825630713834546858387640307817593411764905032303294057112362597297253851687870254992314351948709124427458348128204263663881362955482132512838054738519685384575921373737470245719421223898475756247409282692966862335515090757754459242168056461013405091180148696649963461602177212697836496306046456138474445624214914814699390257673835554848791003397055</span></span><br><span class="line">c4 = <span class="number">260074379614284795599484546451240257157763532480505168853160303924952553177325935242853666448209970957052626857104522597130316456316378917529016900063473199051496246209878864043477905068893003923546332891289993179385753129868269775271722630762054161951558359984426822705582509592976962739279251035941138103001411061238095611738024433238447078804016593599525582868080696498271912174235479368671466666819582104245707176341268617126063957318342864903403961673418935623112290599738566078566393961145470677825235949530460449737989243772214379341818676279908757907698136648847166264635580606733816599243489965651372128251328</span></span><br><span class="line">n5 = <span class="number">70199621485671842359044641866403168058670803503736686351887502686934276983786039926002198676793045683182125769300687612734657616494815167750772182403321230734527784596550124329071164871143795929191396166096178482901122962656943854107741654772981259089537233024363295465966490361367216383217631330482253245796203648485653095242684462412133029510769320566443165990471527944889669809129572843754832577807509454633886982402256837076791468127186325307925886447397529190962280905611709973103713165872442266384750885343667064502988575278416037070011939869923447549518023420261237007329747290577829325263253564790709373901618</span></span><br><span class="line">c5 = <span class="number">207467685064436795719671032825183115862587233648672449925340580227825675452627031507906214773278665727530027025673966750973641715014217092820995216768554881760711270444952703291126925400881160114713107315867759288572987159233984669439942981888636828978580980986834342715153361271280814208437227309185682033733871844684874967978852089340054449142896831217885786745795842561143568848428620959961049292832772489885193639646881909425599177539209159664137785111991625129191354004990699226809474030005545318219197509201907072684957499981194498761673049651408375607248956494019809957851295451628144493493011699904221882421955</span></span><br></pre></td></tr></table></figure>

</blockquote>
<p>分析：</p>
<p>e的范围很小，使用低指数广播攻击</p>
<p>exp.py:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"># 移除 (i+1) 因子</span><br><span class="line">n_list = [n1//2, n2//3, n3//4, n4//5, n5//6]</span><br><span class="line">c_list = [c1//1, c2//2, c3//3, c4//4, c5//5]</span><br><span class="line">mm = libnum.solve_crt(c_list,n_list)    #使用中国剩余定理求解合并的结果</span><br><span class="line">print(&#x27;合并后的模数结果:&#x27;,mm)</span><br><span class="line">for e in range(10,30):</span><br><span class="line">    if gmpy2.is_prime(e):</span><br><span class="line">        # print(e)#11,13,17,19,23,29</span><br><span class="line">        # 低指数广播攻击</span><br><span class="line">        m, t =gmpy2.iroot(mm,e) #计算e次方根</span><br><span class="line">        if t:</span><br><span class="line">            print(f&#x27;解密成功e=&#123;e&#125;,m=&#123;m&#125;&#x27;)</span><br><span class="line">            print(long_to_bytes(m))</span><br><span class="line">#flag&#123;7253348a0594e05548517f1d98eaf790&#125;</span><br></pre></td></tr></table></figure>





<h1 id="playstreamone"><a href="#playstreamone" class="headerlink" title="playstreamone"></a>playstreamone</h1><p>题目：</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">24</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LFSR</span>(<span class="params">R, mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span></span><br><span class="line">    i = (R &amp; mask) &amp; <span class="number">0xffffff</span></span><br><span class="line">    lastbit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">        lastbit ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">        i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">    output ^= lastbit</span><br><span class="line">    <span class="keyword">return</span> output, lastbit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Fx1x2x3</span>(<span class="params">R1, R1_mask, R2, R2_mask, R3, R3_mask</span>):</span><br><span class="line">    R1_NEW, x1 = LFSR(R1, R1_mask)</span><br><span class="line">    R2_NEW, x2 = LFSR(R2, R2_mask)</span><br><span class="line">    R3_NEW, x3 = LFSR(R3, R3_mask)</span><br><span class="line"></span><br><span class="line">    output = (x1 * x2) ^ ((x2 ^ <span class="number">1</span>) * x3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> R1_NEW, R2_NEW, R3_NEW, output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R1 = <span class="built_in">int</span>(flag[<span class="number">5</span>:<span class="number">11</span>], <span class="number">16</span>)</span><br><span class="line">R2 = <span class="built_in">int</span>(flag[<span class="number">11</span>:<span class="number">17</span>], <span class="number">16</span>)</span><br><span class="line">R3 = <span class="built_in">int</span>(flag[<span class="number">17</span>:<span class="number">23</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R1)[<span class="number">2</span>:]) == <span class="number">21</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R2)[<span class="number">2</span>:]) == <span class="number">22</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(R3)[<span class="number">2</span>:]) == <span class="number">21</span></span><br><span class="line"></span><br><span class="line">R1_mask = <span class="number">0x20010</span></span><br><span class="line">R2_mask = <span class="number">0x8002c</span></span><br><span class="line">R3_mask = <span class="number">0x200004</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fi <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Processing file <span class="subst">&#123;fi&#125;</span>&quot;</span>)</span><br><span class="line">    tmp1mb = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">        tmp1kb = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">            tmp = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">                R1, R2, R3, out = Fx1x2x3(R1, R1_mask, R2, R2_mask, R3, R3_mask)</span><br><span class="line">                tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line"></span><br><span class="line">            tmp1kb.append(tmp)</span><br><span class="line"></span><br><span class="line">        tmp1mb.extend(tmp1kb)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;./output/<span class="subst">&#123;fi&#125;</span>&quot;</span>, <span class="string">&quot;ab&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(tmp1mb)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;File <span class="subst">&#123;fi&#125;</span> written successfully.&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#流密码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LFSR</span>(<span class="params">R, mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span></span><br><span class="line">    i = (R &amp; mask) &amp; <span class="number">0xffffff</span></span><br><span class="line">    lastbit = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">        lastbit ^= (i &amp; <span class="number">1</span>)</span><br><span class="line">        i = i &gt;&gt; <span class="number">1</span></span><br><span class="line">    output ^= lastbit</span><br><span class="line">    <span class="keyword">return</span> output, lastbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Fx1x2x3</span>(<span class="params">R1, R1_mask, R2, R2_mask, R3, R3_mask</span>):</span><br><span class="line">    R1_NEW, x1 = LFSR(R1, R1_mask)</span><br><span class="line">    R2_NEW, x2 = LFSR(R2, R2_mask)</span><br><span class="line">    R3_NEW, x3 = LFSR(R3, R3_mask)</span><br><span class="line">    output = (x1 * x2) ^ ((x2 ^ <span class="number">1</span>) * x3)</span><br><span class="line">    <span class="keyword">return</span> R1_NEW, R2_NEW, R3_NEW, output</span><br><span class="line"></span><br><span class="line">n3 = <span class="number">21</span></span><br><span class="line">n2 = <span class="number">22</span></span><br><span class="line">n1 = <span class="number">21</span></span><br><span class="line"></span><br><span class="line">R1_mask = <span class="number">0x20010</span></span><br><span class="line">R2_mask = <span class="number">0x8002c</span></span><br><span class="line">R3_mask = <span class="number">0x200004</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>(<span class="params">beg, end, num, mask</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./output/0&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read(num)</span><br><span class="line"></span><br><span class="line">    data = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">bin</span>(byte)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> data)</span><br><span class="line"></span><br><span class="line">    now = <span class="number">0</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(beg, end):</span><br><span class="line">        r = i</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(num*<span class="number">8</span>):</span><br><span class="line">            r, lastbit = LFSR(r,mask)</span><br><span class="line">            lastbit = <span class="built_in">str</span>(lastbit)</span><br><span class="line">            cnt += (lastbit == data[j])</span><br><span class="line">        <span class="keyword">if</span> cnt &gt; now:</span><br><span class="line">            now = cnt</span><br><span class="line">            res = i</span><br><span class="line">            <span class="built_in">print</span>(now, res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bruteforce</span>(<span class="params">x, z</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./output/0&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read(<span class="number">50</span>)</span><br><span class="line">        data = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">bin</span>(byte)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">pow</span>(<span class="number">2</span>,n2-<span class="number">1</span>), <span class="built_in">pow</span>(<span class="number">2</span>,n2)):</span><br><span class="line">        R1, R2, R3 = x,y,z</span><br><span class="line">        flag = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">            (R1, R2, R3, out) = Fx1x2x3(R1,R1_mask, R2,R2_mask, R3,R3_mask)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(out) != data[i]:</span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> y%<span class="number">10000</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;now:&#x27;</span>,x,y,z)</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;ans:&#x27;</span>, <span class="built_in">hex</span>(x)[<span class="number">2</span>:], <span class="built_in">hex</span>(y)[<span class="number">2</span>:], <span class="built_in">hex</span>(z)[<span class="number">2</span>:])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># R1 = guess(pow(2,n1-1), pow(2,n1), 40,R1_mask)</span></span><br><span class="line"><span class="comment"># print(R1)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># R3 = guess(pow(2,n3-1), pow(2,n3), 40,R3_mask)</span></span><br><span class="line"><span class="comment"># print(R3)</span></span><br><span class="line"></span><br><span class="line">R1 = <span class="number">1225459</span></span><br><span class="line">R3 = <span class="number">1613986</span></span><br><span class="line">bruteforce(R1, R3)</span><br><span class="line"><span class="comment">#flag&#123;12b2f329cb0518a0a2&#125;</span></span><br></pre></td></tr></table></figure>


      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源 </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">赏</a>
</p>






    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<input type="hidden" id="MathJax-js"
        value="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</input>
    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2016-2020 Yelog
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
